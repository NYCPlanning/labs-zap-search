<div
  class="project-summary-card callout"
  data-test-project-card
>
  <div class="grid-x grid-x-small-gutters">
    <div class="cell large-4 xlarge-5">
      <h3 class="tiny-margin-bottxrom">
        <LinkTo 
          @route="show-project"
          @model={{this.assignment.project.id}}
          data-test-project-profile-button="{{this.assignment.project.id}}"
        >
          {{this.assignment.project.dcpProjectname}}
        </LinkTo>
        <small class="dark-gray">{{this.assignment.project.dcpUlurpNonulurp}}</small>
      </h3>
      <h5 class="applicant">{{this.assignment.project.applicants}}</h5>
      <p>{{this.assignment.project.dcpProjectbrief}}</p>
    </div>
    <div class="cell medium-4 large-3 xlarge-2">
      <div class="text-center medium-margin-right medium-margin-left">
        <p class="tiny-margin-bottom" data-test-milestone-label="{{this.assignment.id}}">{{participant-type-label this.assignment.dcpLupteammemberrole}} Review</p>
        {{#if this.assignment.toReviewMilestonePlannedCompletionDate}}
          {{#if this.assignment.toReviewMilestoneTimeRemaining}}
            <p>
              <strong class="stat"
                data-test-time-remaining="{{this.assignment.id}}"
              >
                {{this.assignment.toReviewMilestoneTimeRemaining}}
              </strong>
              {{#if this.assignment.toReviewMilestoneTimeDuration}}
                <strong class="display-block" data-test-time-duration="{{this.assignment.id}}">
                  of {{this.assignment.toReviewMilestoneTimeDuration}} days remain
                  <sup class="dark-gray"><IconTooltip @icon='info-circle' @tip='Review periods ending on a weekend or public holiday are extended to the next business day.'/></sup>
                </strong>
              {{else}}
                <strong class="display-block" data-test-no-time-duration-message="{{this.assignment.id}}">days remain</strong>
              {{/if}}
            </p>
          {{/if}}
          <p class="text-tiny">
            Ends <DateDisplay @date={{this.assignment.toReviewMilestonePlannedCompletionDate}} @outputFormat="M/D/YYYY" />
          </p>
        {{else}}
          <br>
          <p
            data-test-invalid-milestone-end-date
          >
            The end date for your review is missing in our system, please contact DCP.
          </p>
        {{/if}}
      </div>
    </div>
    <div class="cell medium-8 large-auto">
      {{#if this.assignment.hearingsNotSubmittedNotWaived}}
        <div class="grid-x">
          <div class="cell medium-auto">
            <LinkTo
              @route={{if this.assignment.dispositionsByRole "my-projects.assignment.hearing.add"}}
              @model={{if this.assignment.dispositionsByRole this.assignment}}
              class="button expanded tiny-margin-bottom"
              disabled={{not this.assignment.dispositionsByRole}}
              data-test-button-post-hearing="{{this.assignment.id}}"
            >
              {{fa-icon 'calendar' fixedWidth=true size="lg" transform="left-2"}}
              Post {{participant-type-label this.assignment.dcpLupteammemberrole}} Hearing Notice
            </LinkTo>
          </div>
          <div class="cell medium-shrink">
            <button
              type="button"
              class="button expanded gray"
              onClick={{fn this.openOptOutHearingPopup}}
              disabled={{not this.assignment.dispositions}}
              data-test-button-opt-out-hearing-popup="{{this.assignment.id}}"
            >
              {{fa-icon 'calendar-times' size="lg" transform="shrink-5 down-1"}}
              <small>Opt Out</small>
            </button>
          </div>
        </div>
      {{else}}
        {{#if this.assignment.hearingsWaived}}
          <span class="opt-out-notice" data-test-hearings-waived-message="{{this.assignment.project.id}}">
            {{fa-icon 'calendar-times' size="lg" transform="left-2"}}
            You've opted out of posting a hearing
          </span>
        {{/if}}
      {{/if}}

      {{#if this.assignment.hearingsSubmittedOrWaived}}
        <LinkTo @route="my-projects.assignment.recommendations.add"
          @model={{this.assignment}}
          class="button expanded"
          data-test-button="submitRecommendation"
        >
          {{fa-icon 'thumbs-up' fixedWidth=true size="lg"}}
          {{fa-icon 'thumbs-down' fixedWidth=true size="lg" transform="flip-h left-2"}}
          Submit {{participant-type-label this.assignment.dcpLupteammemberrole}} Recommendation
        </LinkTo>
      {{else}}
        <a class="button expanded" disabled>
          {{fa-icon 'thumbs-up' fixedWidth=true size="lg"}}
          {{fa-icon 'thumbs-down' fixedWidth=true size="lg" transform="flip-h left-2"}}
          Submit {{participant-type-label this.assignment.dcpLupteammemberrole}} Recommendation
        </a>
      {{/if}}
      <WaiveHearingsPopup @assignment={{this.assignment}} @showPopup={{this.showPopup}}/>

      {{#if this.assignment.hearingsSubmitted}}
        <DedupedHearingsList @dispositions={{this.assignment.dispositionsByRole}} as |dedupedHearings|>
          <h6>{{participant-type-label this.assignment.dcpLupteammemberrole}} Hearings:</h6>
              <ul class="no-bullet">
              {{#each dedupedHearings as |hearing|}}
                <li class="grid-x small-margin-bottom">
                  <div class="cell shrink small-margin-right">
                    {{#if (is-before hearing.disposition.dcpDateofpublichearing)}}
                      {{fa-icon "calendar" class="light-gray" fixedWidth=true}}
                    {{else}}
                      {{fa-icon "check" class="blue" fixedWidth=true}}
                    {{/if}}
                  </div>
                  <div class="cell auto">
                    <strong data-test-hearing-location="{{hearing.disposition.id}}" class="display-inline-block">
                      {{~hearing.disposition.dcpPublichearinglocation~}}
                    </strong>

                    <span class="display-inline-block">
                      <span data-test-hearing-date="{{hearing.disposition.id}}">
                        <DateDisplay @date={{hearing.disposition.dcpDateofpublichearing}} />
                      </span>
                      <span class="light-gray">|</span>
                      <span data-test-hearing-time="{{hearing.disposition.id}}">
                        <DateDisplay @date={{hearing.disposition.dcpDateofpublichearing}} @outputFormat="h:mm A" />
                      </span>
                    </span>

                    <small data-test-hearing-actions-list="{{hearing.disposition.id}}">
                      {{#each hearing.hearingActions as |action| ~}}
                        {{#if action.dcpName}}
                          <span class="label light-gray tiny-margin-bottom tiny-margin-right">
                            {{action.dcpName}}
                            <small>{{action.dcpUlurpnumber}}</small>
                          </span>
                        {{/if}}
                      {{~/each}}
                    </small>
                  </div>
                </li>
              {{/each}}
              </ul>
        </DedupedHearingsList>
      {{/if}}

    </div>
  </div>
</div>
