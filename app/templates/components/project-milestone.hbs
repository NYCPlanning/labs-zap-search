<div class="cell shrink">
  {{#if (eq tense "past")}}
    <span class="milestone-icon fa-layers fa-fw">
      {{fa-icon 'circle' fixedWidth=true class='dark-gray'}}
      {{fa-icon 'check' fixedWidth=true class='blue-light' transform='shrink-6'}}
    </span>
  {{else if (eq tense "present")}}
    <span class="milestone-icon fa-layers fa-fw">
      {{fa-icon 'circle' fixedWidth=true class='green-dark'}}
      {{fa-icon 'calendar' prefix='far' fixedWidth=true class='white-smoke' transform='shrink-8'}}
    </span>
  {{else}}{{!-- future --}}
    <span class="milestone-icon fa-layers fa-fw">
      {{fa-icon 'circle' fixedWidth=true class='light-gray'}}
      {{fa-icon 'calendar' prefix='far' fixedWidth=true class='off-white' transform='shrink-8'}}
    </span>
  {{/if}}
</div>
<div class="cell auto {{if (or (eq tense 'past') (eq tense 'present')) '' 'gray'}}">
  <h5 class="no-margin">
    {{milestone.orderSensitiveName}}

    {{#if milestone.displayDescription}}
      <sup class="gray">
        {{icon-tooltip tip=milestone.displayDescription}}
      </sup>
    {{/if}}
  </h5>
  {{#if milestone.displayDate}}
    <div class="milestone-dates">
      {{#if milestone.displayDate}}
        <div>
          <DateDisplay
            @date={{milestone.displayDate}}
            @outputFormat="MMMM D, YYYY"
          />
          {{#if milestone.displayDate2}}<small>Start</small>{{/if}}
        </div>
      {{/if}}
      {{#if milestone.displayDate2}}
        <div>
          <DateDisplay
            @date={{milestone.displayDate2}}
            @outputFormat="MMMM D, YYYY"
          />
          <small>End</small>
        </div>
      {{/if}}
      {{#if timeRelativeToNow}}
        <div class="milestone-offset">{{timeRelativeToNow}}</div>
      {{/if}}
    </div>
    {{#if milestone.dcpMilestoneoutcome}} <span class="label dark-gray" style="font-size: 0.7rem;">{{milestone.dcpMilestoneoutcome}}</span> {{/if}}
    <ul class="milestone-links">
      {{#if (eq milestone.dcpMilestone "9e3beec4-dad0-e711-8116-1458d04e2fb8")}}
        <li><a href="https://www1.nyc.gov/site/planning/about/commission-meetings.page" target="_blank">{{fa-icon "external-link-alt"}} CPC Public Meeting Calendar</a></li>
      {{/if}}
      {{#if (eq milestone.dcpMilestone "a43beec4-dad0-e711-8116-1458d04e2fb8")}}
        <li><a href="http://a030-cpc.nyc.gov/html/cpc/index.aspx" target="_blank">{{fa-icon "external-link-alt"}} CPC Reports</a></li>
      {{/if}}
      {{#each milestone.milestoneLinks as |link|}}
        <li><a href="{{link.url}}" target="_blank">{{link.filename}}</a></li>
      {{/each}}
    </ul>
  {{/if}}
  {{#hearings-list-for-milestones-list milestone=milestone as |milestoneParticipants|}}
    {{#each milestoneParticipants as |milestoneParticipant|}}
      {{#if milestoneParticipant.hearingsSubmitted}}
        <h6 data-test-hearing-title="{{milestoneParticipant.landUseParticipantFullName}}">
          {{milestoneParticipant.landUseParticipantFullName}} Public Hearing
        </h6>
        {{#deduped-hearings-list dispositions=milestoneParticipant.userDispositions as |dedupedHearings|}}
          {{#each dedupedHearings as |hearing|}}
            <ul class="sub-milestones no-bullet">
              <li class="grid-x">
                <div class="cell shrink small-margin-right">
                  {{#if (is-before disposition.dcpDateofpublichearing)}}
                    {{fa-icon 'calendar' fixedWidth=true class='light-gray'}}
                  {{else}}
                    {{fa-icon 'check' fixedWidth=true class='blue-muted'}}
                  {{/if}}
                </div>
                <div class="cell auto">
                  <small>{{hearing.disposition.dcpPublichearinglocation}}</small>
                  <small class="datetime">{{~moment-format hearing.disposition.dcpDateofpublichearing "LLLL"~}}</small>
                  <span class="display-block text-tiny">
                    {{#each hearing.hearingActions as |action index|}}
                      <span class="label light-gray tiny-margin-bottom tiny-margin-right" data-test-hearing-actions-list="{{index}}">
                        {{action.dcpName}}
                        <small>{{action.dcpUlurpnumber}}</small>
                      </span>
                    {{/each}}
                  </span>
                </div>
              </li>
            </ul>
          {{/each}}
        {{/deduped-hearings-list}}
      {{/if}}
        {{#if milestoneParticipant.hearingsWaived}}
          {{fa-icon 'calendar-times' fixedWidth=true class='light-gray'}}
          <small data-test-hearing-title="{{milestoneParticipant.landUseParticipantFullName}}">
            No {{milestoneParticipant.landUseParticipantFullName}} Hearings Posted
          </small>
        {{/if}}
        {{#if milestoneParticipant.votesSubmitted}}
          <h6>{{milestoneParticipant.landUseParticipantFullName}} Vote:</h6>
              <ul class="sub-milestones no-bullet">
                <li class="grid-x">
                  <div class="cell shrink small-margin-right">
                    {{#if (or (eq milestoneParticipant.participantRecommendation 'Approved') (eq milestoneParticipant.participantRecommendation 'Approved with Modifications/Conditions'))}}
                      {{fa-icon 'thumbs-up' fixedWidth=true class='green-muted'}}
                    {{else if (or (eq milestoneParticipant.participantRecommendation 'Disapproved') (eq milestoneParticipant.participantRecommendation 'Disapproved with Modifications/Conditions'))}}
                      {{fa-icon 'thumbs-down' fixedWidth=true class='red-muted'}}
                    {{else if (eq milestoneParticipant.participantRecommendation 'Waived')}}
                      {{fa-icon 'comment-slash' fixedWidth=true class='light-gray'}}
                    {{/if}}
                  </div>
              {{#deduped-votes-list dispositions=milestoneParticipant.userDispositions participantRecommendationType=milestoneParticipant.participantRecommendationType as |dedupedVotes|}}
                {{#each dedupedVotes as |vote|}}
                  <div class="cell auto">
                    <small>
                      <span class="display-inline-block">{{vote.disposition.dcpVotinginfavorrecommendation}} In Favor,</span>
                      <span class="display-inline-block">{{vote.disposition.dcpVotingagainstrecommendation}} Against,</span>
                      <span class="display-inline-block">{{vote.disposition.dcpVotingabstainingonrecommendation}} Abstain</span>
                    </small>
                    <small class="display-inline-block">{{~moment-format vote.disposition.dcpDateofvote "LL"~}}</small>
                    <span class="display-block text-tiny">
                      {{#each vote.voteActions as |action index|}}
                        <span class="label light-gray tiny-margin-bottom tiny-margin-right" data-test-hearing-actions-list="{{index}}">
                          {{action.dcpName}}
                          <small>{{action.dcpUlurpnumber}}</small>
                        </span>
                      {{/each}}
                    </span>
                  </div>
                {{/each}}
              {{/deduped-votes-list}}
            </li>
          </ul>
        {{/if}}
      {{/each}}
    {{/hearings-list-for-milestones-list}}
</div>

{{yield}}
